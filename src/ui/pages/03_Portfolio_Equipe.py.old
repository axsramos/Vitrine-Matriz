import streamlit as st
from src.services.dev_service import DevService
from src.core.ui_utils import load_avatar
from src.core.auth_middleware import require_auth

# Prote√ß√£o de acesso
# require_auth()

st.title("üë• Time de Desenvolvedores")
st.write("Conhe√ßa os especialistas por tr√°s do ecossistema Vitrine-Matriz.")

dev_service = DevService()
equipe = dev_service.get_all_developers()

if not equipe:
    st.info("Nenhum portf√≥lio registrado no momento.")
else:
    # --- CENTRALIZA√á√ÉO EM COLUNA √öNICA ---
    # Criamos 3 colunas: [Margem, Conte√∫do, Margem]
    # O conte√∫do central ocupa 6 partes de 12 (50% da largura da tela)
    _, col_central, _ = st.columns([2, 8, 2])

    with col_central:
        for dev in equipe:
            # Container com borda para isolar cada desenvolvedor
            with st.container(border=True):
                # Sub-colunas para Foto vs Texto dentro do card centralizado
                col_img, col_txt = st.columns([1, 2])
                
                with col_img:
                    foto = dev.get('DevFto')
                    img = load_avatar(foto) 
                    st.image(img, use_container_width=True)
                
                with col_txt:
                    st.subheader(dev.get('DevNom', 'Desenvolvedor'))
                    
                    bio = dev.get('DevBio') or "Desenvolvedor focado em solu√ß√µes tecnol√≥gicas."
                    st.write(bio)
                    
                    link = dev.get('DevLnk')
                    if link:
                        url_final = link if link.startswith(('http://', 'https://')) else f"https://{link}"
                        st.link_button("üîó Ver Portf√≥lio Profissional", url_final, use_container_width=True)
                    else:
                        st.caption("üåê Link do portf√≥lio n√£o cadastrado.")
            
            # Espa√ßamento entre os cards
            st.write("") 

st.divider()
st.caption("Dados sincronizados com a branch fix/fast.")